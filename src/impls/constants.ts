"use strict";

/**
 * Created by zacharymartin on September 15, 2016.
 */

export const C = {
  LNSQRTTWOPI: 0.9189385332046727418,             // Math.log(Math.sqrt(2 * Math.PI))
  SQRTTWOPI: 2.5066282746310005024,               // Math.sqrt(2 * Math.PI)
  EULMASC: 0.5772156649015328606,                 // Euler-Mascheroni constant
  PIHALF: 1.5707963267948966192,                  // Math.PI/2
  PIKWART: 0.7853981633974483096,                 // Math.PI/4
  PIDRIEKWART: 2.3561944901923449288,             // (3 * Math.PI)/4
  SQRTPI: 1.7724538509055160272,                  // Math.sqrt(Math.PI)
  LNPI: 1.1447298858494001741,                    // Math.log(Math.PI)
  ONEPI: .31830988618379067153,                   // 1/Math.PI
  SQRT2: 1.4142135623730950488,                   // Math.sqrt(2)
  SQRT3: 1.7320508075688772935,                   // Math.sqrt(3)
  SQRT2OPI: 0.7978845608028653559,                // Math.sqrt(2/Math.PI)
  TWOPI: 6.2831853071795864769,                   // 2*Math.PI
  ONEOVERSQRTPI: 0.5641895835477562869,           // 1/Math.sqrt(Math.PI)
  ONEOVERSQRTTWOPI: 0.3989422804014327,           // 1/Math.sqrt(2*Math.PI)
  TWOOVERSQRTPI: 1.1283791670955125739,           // 2/Math.sqrt(Math.PI)
  ONETHIRD: 0.3333333333333333333,                // 1/3
  TWOTHIRD: 0.6666666666666666667,                // 2/3
  ONESIX: 0.1666666666666666667,                  // 1/6
  TWOEXP14: 1.1892071150027210667,                // 2^(1/4)
  TWOEXPNEG32: 0.3535533905932738,                // 2^(-3/2)
  EPSS: 1e-15,                                    // demanded accuracy
  DWARF: Number.MIN_VALUE * 1000,                 // safe underflow limit
  BIG_DWARF: Number.MIN_VALUE * 1e+15,            // even safer underflow limit
  GIANT: Number.MAX_VALUE / 1000,                 // safe overflow limit
  BABY_GIANT: Number.MAX_VALUE / 1e+15,           // even safer overflow limit
  MACHTOL: Number.MIN_VALUE,                      // machine-epsilon at 0
  MACHTOL1: 2.220446049250313e-16,                // algorithm 708
  EXPLOW: -300,
  EXPHIGH: 300,

  AK_ARRAY: [
    -0.98283078605877425496,
    0.7611416167043584304e-1,
    -0.843232496593277796e-2,
    0.107949372632860815e-2,
    -0.14900748003692965e-3,
    0.2151239988855679e-4,
    -0.319793298608622e-5,
    0.48516930121399e-6,
    -0.7471487821163e-7,
    0.1163829670017e-7,
    -0.182940043712e-8,
    0.28969180607e-9,
    -0.4615701406e-10,
    0.739281023e-11,
    -0.118942800e-11,
    0.19212069e-12,
    -0.3113976e-13,
    0.506284e-14,
    -0.82542e-15,
    0.13491e-15,
    -0.2210e-16,
    0.363e-17,
    -0.60e-18,
    0.98e-19,
    -0.2e-19,
    0.3e-20
  ],
  R8_ARRAY: [
    1.230339354797997253e3,
    2.051078377826071465e3,
    1.712047612634070583e3,
    8.819522212417690904e2,
    2.986351381974001311e2,
    6.611919063714162948e1,
    8.883149794388375941,
    5.641884969886700892e-1,
    2.153115354744038463e-8
  ],
  S8_ARRAY: [
    1.230339354803749420e3,
    3.439367674143721637e3,
    4.362619090143247158e3,
    3.290799235733459627e3,
    1.621389574566690189e3,
    5.371811018620098575e2,
    1.176939508913124993e2,
    1.574492611070983473e1
  ],
  R5_ARRAY: [
    6.587491615298378032e-4,
    1.608378514874227663e-2,
    1.257817261112292462e-1,
    3.603448999498044394e-1,
    3.053266349612323440e-1,
    1.631538713730209785e-2
  ],
  S5_ARRAY: [
    2.335204976268691854e-3,
    6.051834131244131912e-2,
    5.279051029514284122e-1,
    1.872952849923460472,
    2.568520192289822421
  ],
  R4_ARRAY: [
    3.209377589138469473e3,
    3.774852376853020208e2,
    1.138641541510501556e2,
    3.161123743870565597e0,
    1.857777061846031527e-1
  ],
  S4_ARRAY: [
    2.844236833439170622e3,
    1.282616526077372276e3,
    2.440246379344441733e2,
    2.360129095234412093e1
  ],
  FM_ARRAY: [
    1,
    -1 / 3,
    1 / 12,
    -2 / 135,
    1 / 864,
    1 / 2835,
    -139 / 777600,
    1 / 25515,
    -571 / 261273600,
    -281 / 151559100,
    8.29671134095308601e-7,
    -1.76659527368260793e-7,
    6.70785354340149857e-9,
    1.02618097842403080e-8,
    -4.38203601845335319e-9,
    9.14769958223679023e-10,
    -2.55141939949462497e-11,
    -5.83077213255042507e-11,
    2.43619480206674162e-11,
    -5.02766928011417559e-12,
    1.10043920319561347e-13,
    3.37176326240098538e-13,
    -1.39238872241816207e-13,
    2.85348938070474432e-14,
    -5.13911183424257258e-16,
    -1.97522882943494428e-15,
    8.09952115670456133e-16,
  ],
  C_ARRAY: [
    0.25721014990011306473e-1,
    0.82475966166999631057e-1,
    -0.25328157302663562668e-2,
    0.60992926669463371e-3,
    -0.33543297638406e-3,
    0.250505279903e-3,
    0.30865217988013567769
  ],
  A_ARRAY: [
    1.996379051590076518221,
    -0.17971032528832887213e-2,
    0.131292857963846713e-4,
    -0.2340875228178749e-6,
    0.72291210671127e-8,
    -0.3280997607821e-9,
    0.198750709010e-10,
    -0.15092141830e-11,
    0.1375340084e-12,
    -0.145728923e-13,
    0.17532367e-14,
    -0.2351465e-15,
    0.346551e-16,
    -0.55471e-17,
    0.9548e-18,
    -0.1748e-18,
    0.332e-19,
    -0.58e-20
  ],
  DR_ARRAY: [
    -1.013609258009865776949,
    0.784903531024782283535e-1,
    0.67588668743258315530e-2,
    -0.12790434869623468120e-2,
    0.462939838642739585e-4,
    0.43381681744740352e-5,
    -0.5326872422618006e-6,
    0.172233457410539e-7,
    0.8300542107118e-9,
    -0.10553994239968e-9,
    0.39415842851e-11,
    0.362068537e-13,
    -0.107440229e-13,
    0.5000413e-15,
    -0.62452e-17,
    -0.5185e-18,
    0.347e-19,
    -0.9e-21
  ],
  // algorithm 708
  C2_ARRAY: [
    .833333333333333e-01,
    -.277777777760991e-02,
    .793650666825390e-03,
    -.595202931351870e-03,
    .837308034031215e-03,
    -.165322962780713e-02
  ],
  P_ARRAY: [
    .577215664901533,
    .844203922187225,
    -.168860593646662,
    -.780427615533591,
    -.402055799310489,
    -.673562214325671e-01,
    -.271935708322958e-02
  ],
  Q2_ARRAY: [
    .288743195473681e+01,
    .312755088914843e+01,
    .156875193295039e+01,
    .361951990101499e+00,
    .325038868253937e-01,
    .667465618796164e-03
  ],
  RALT_ARRAY: [
    .422784335098467,
    .848044614534529,
    .565221050691933,
    .156513060486551,
    .170502484022650e-01,
    .497958207639485e-03
  ],
  SALT_ARRAY: [
    .124313399877507e+01,
    .548042109832463,
    .101552187439830,
    .713309612391000e-02,
    .116165475989616e-03
  ],
  PSI1_PIOV4: 0.785398163397448,
  PSI1_DX0: 1.461632144968362341262659542325721325,
  PSI1_P1_ARRAY: [
    .895385022981970e-02,
    .477762828042627e+01,
    .142441585084029e+03,
    .118645200713425e+04,
    .363351846806499e+04,
    .413810161269013e+04,
    .130560269827897e+04
  ],
  PSI1_Q1_ARRAY: [
    .448452573429826e+02,
    .520752771467162e+03,
    .221000799247830e+04,
    .364127349079381e+04,
    .190831076596300e+04,
    .691091682714533e-05
  ],
  PSI1_P2_ARRAY: [
    -.212940445131011e+01,
    -.701677227766759e+01,
    -.448616543918019e+01,
    -.648157123766197e+00
  ],
  PSI1_Q2_ARRAY: [
    .322703493791143e+02,
    .892920700481861e+02,
    .546117738103215e+02,
    .777788548522962e+01
  ],
  ASPER_G: .577215664901533,
  RLOG1_A: .566749439387324e-01,
  RLOG1_B: .456512608815524e-01,
  RLOG1_P_ARRAY: [
    .333333333333333,
    -.224696413112536,
    .620886815375787e-02
  ],
  RLOG_Q1: -.127408923933623e+01,
  RLOG_Q2: .354508718369557,
  ERFC1_C: .564189583547756,
  ERFC1_A_ARRAY: [
    .771058495001320e-04,
    -.133733772997339e-02,
    .323076579225834e-01,
    .479137145607681e-01,
    .128379167095513
  ],
  ERFC1_B_ARRAY: [
    .301048631703895e-02,
    .538971687740286e-01,
    .375795757275549e+00
  ],
  ERFC1_P_ARRAY: [
    -1.36864857382717e-07,
    5.64195517478974e-01,
    7.21175825088309,
    4.31622272220567e+01,
    1.52989285046940e+02,
    3.39320816734344e+02,
    4.51918953711873e+02,
    3.00459261020162e+02
  ],
  ERFC1_Q_ARRAY: [
    1,
    1.27827273196294e+01,
    7.70001529352295e+01,
    2.77585444743988e+02,
    6.38980264465631e+02,
    9.31354094850610e+02,
    7.90950925327898e+02,
    3.00459260956983e+02
  ],
  ERFC1_R_ARRAY: [
    2.10144126479064,
    2.62370141675169e+01,
    2.13688200555087e+01,
    4.65807828718470,
    2.82094791773523e-01
  ],
  ERFC1_S_ARRAY: [
    9.41537750555460e+01,
    1.87114811799590e+02,
    9.90191814623914e+01,
    1.80124575948747e+01
  ],
  GAM1_S1: .273076135303957,
  GAM1_S2: .559398236957378e-01,
  GAM1_P_ARRAY: [
    .577215664901533,
    -.409078193005776,
    -.230975380857675,
    .597275330452234e-01,
    .766968181649490e-02,
    -.514889771323592e-02,
    .589597428611429e-03
  ],
  GAM1_Q_ARRAY: [
    1,
    .427569613095214,
    .158451672430138,
    .261132021441447e-01,
    .423244297896961e-02
  ],
  GAM1_R_ARRAY: [
    -.422784335098468,
    -.771330383816272,
    -.244757765222226,
    .118378989872749,
    .930357293360349e-03,
    -.118290993445146e-01,
    .223047661158249e-02,
    .266505979058923e-03,
    -.132674909766242e-03
  ],
  REXP_P_ARRAY: [
    .914041914819518e-09,
    .238082361044469e-01
  ],
  REXP_Q_ARRAY: [
    -.499999999085958,
    .107141568980644,
    -.119041179760821e-01,
    .595130811860248e-03
  ],
  EXPM1_Y: 0.10281276702880859375e1,
  EXPM1_N_ARRAY: [
    -0.281276702880859375e-1,
    0.512980290285154286358e0,
    -0.667758794592881019644e-1,
    0.131432469658444745835e-1,
    -0.72303795326880286965e-3,
    0.447441185192951335042e-4,
    -0.714539134024984593011e-6
  ],
  EXPM1_D_ARRAY: [
    1.0,
    -0.461477618025562520389e0,
    0.961237488025708540713e-1,
    -0.116483957658204450739e-1,
    0.873308008461557544458e-3,
    -0.387922804997682392562e-4,
    0.807473180049193557294e-6
  ],
  LANCZOS_NUM_ARRAY: [
    86091529.53418537217994842267760536134841,
    81354505.17858011242874285785316135398567,
    35236626.38815461910817650960734605416521,
    9249814.988024471294683815872977672237195,
    1639024.216687146960253839656643518985826,
    206530.8157641225032631778026076868855623,
    18976.70193530288915698282139308582105936,
    1281.068909912559479885759622791374106059,
    63.06093343420234536146194868906771599354,
    2.207470909792527638222674678171050209691,
    0.05216058694613505427476207805814960742102,
    0.0007469903808915448316510079585999893674101,
    0.4903180573459871862552197089738373164184e-5
  ],
  LANCZOS_DENOM_ARRAY: [
    0,
    39916800,
    120543840,
    150917976,
    105258076,
    45995730,
    13339535,
    2637558,
    357423,
    32670,
    1925,
    66,
    1
  ],
  LANCZOS_G: 13.1445650000000000545696821063756942749,
  FACTORIALS_ARRAY: [
    1,
    1,
    2,
    6,
    24,
    120,
    720,
    5040,
    40320,
    362880,
    3628800,
    39916800,
    479001600,
    6227020800,
    87178291200,
    1307674368000,
    20922789888000,
    355687428096000,
    6402373705728000,
    121645100408832000,
    2432902008176640000,
    51090942171709440000,
    1.1240007277776077e+21,
    2.585201673888498e+22,
    6.204484017332394e+23,
    1.5511210043330986e+25,
    4.0329146112660565e+26,
    1.0888869450418352e+28,
    3.0488834461171387e+29,
    8.841761993739702e+30,
    2.6525285981219107e+32,
    8.222838654177922e+33,
    2.631308369336935e+35,
    8.683317618811886e+36,
    2.9523279903960416e+38,
    1.0333147966386145e+40,
    3.7199332678990125e+41,
    1.3763753091226346e+43,
    5.230226174666011e+44,
    2.0397882081197444e+46,
    8.159152832478977e+47,
    3.345252661316381e+49,
    1.40500611775288e+51,
    6.041526306337383e+52,
    2.658271574788449e+54,
    1.1962222086548019e+56,
    5.502622159812089e+57,
    2.5862324151116818e+59,
    1.2413915592536073e+61,
    6.082818640342675e+62,
    3.0414093201713376e+64,
    1.5511187532873822e+66,
    8.065817517094388e+67,
    4.2748832840600255e+69,
    2.308436973392414e+71,
    1.2696403353658276e+73,
    7.109985878048635e+74,
    4.0526919504877214e+76,
    2.3505613312828785e+78,
    1.3868311854568984e+80,
    8.32098711274139e+81,
    5.075802138772248e+83,
    3.146997326038794e+85,
    1.98260831540444e+87,
    1.2688693218588417e+89,
    8.247650592082472e+90,
    5.443449390774431e+92,
    3.647111091818868e+94,
    2.4800355424368305e+96,
    1.711224524281413e+98,
    1.1978571669969892e+100,
    8.504785885678623e+101,
    6.1234458376886085e+103,
    4.4701154615126844e+105,
    3.307885441519386e+107,
    2.48091408113954e+109,
    1.8854947016660504e+111,
    1.4518309202828587e+113,
    1.1324281178206297e+115,
    8.946182130782976e+116,
    7.156945704626381e+118,
    5.797126020747368e+120,
    4.753643337012842e+122,
    3.945523969720659e+124,
    3.314240134565353e+126,
    2.81710411438055e+128,
    2.4227095383672734e+130,
    2.107757298379528e+132,
    1.8548264225739844e+134,
    1.650795516090846e+136,
    1.4857159644817615e+138,
    1.352001527678403e+140,
    1.2438414054641308e+142,
    1.1567725070816416e+144,
    1.087366156656743e+146,
    1.032997848823906e+148,
    9.916779348709496e+149,
    9.619275968248212e+151,
    9.426890448883248e+153,
    9.332621544394415e+155,
    9.332621544394415e+157,
    9.42594775983836e+159,
    9.614466715035127e+161,
    9.90290071648618e+163,
    1.0299016745145628e+166,
    1.081396758240291e+168,
    1.1462805637347084e+170,
    1.226520203196138e+172,
    1.324641819451829e+174,
    1.4438595832024937e+176,
    1.588245541522743e+178,
    1.7629525510902446e+180,
    1.974506857221074e+182,
    2.2311927486598138e+184,
    2.5435597334721877e+186,
    2.925093693493016e+188,
    3.393108684451898e+190,
    3.969937160808721e+192,
    4.684525849754291e+194,
    5.574585761207606e+196,
    6.689502913449127e+198,
    8.094298525273444e+200,
    9.875044200833601e+202,
    1.214630436702533e+205,
    1.506141741511141e+207,
    1.882677176888926e+209,
    2.372173242880047e+211,
    3.0126600184576594e+213,
    3.856204823625804e+215,
    4.974504222477287e+217,
    6.466855489220474e+219,
    8.47158069087882e+221,
    1.1182486511960043e+224,
    1.4872707060906857e+226,
    1.9929427461615188e+228,
    2.6904727073180504e+230,
    3.659042881952549e+232,
    5.012888748274992e+234,
    6.917786472619489e+236,
    9.615723196941089e+238,
    1.3462012475717526e+241,
    1.898143759076171e+243,
    2.695364137888163e+245,
    3.854370717180073e+247,
    5.5502938327393044e+249,
    8.047926057471992e+251,
    1.1749972043909107e+254,
    1.727245890454639e+256,
    2.5563239178728654e+258,
    3.80892263763057e+260,
    5.713383956445855e+262,
    8.62720977423324e+264,
    1.3113358856834524e+267,
    2.0063439050956823e+269,
    3.0897696138473508e+271,
    4.789142901463394e+273,
    7.471062926282894e+275,
    1.1729568794264145e+278,
    1.853271869493735e+280,
    2.9467022724950384e+282,
    4.7147236359920616e+284,
    7.590705053947219e+286,
    1.2296942187394494e+289,
    2.0044015765453026e+291,
    3.287218585534296e+293,
    5.423910666131589e+295,
    9.003691705778438e+297,
    1.503616514864999e+300,
    2.5260757449731984e+302,
    4.269068009004705e+304,
    7.257415615307999e+306,
  ],
  MAX_FACTORIAL: 170
};
export const c = C;

// function factorial(n) {
//   if (n === 0) {
//     return 1;
//   }
//
//   let result = 1;
//
//   for (let i=1; i <= n; i++) {
//     result *= i;
//   }
//
//   return result;
// }
//
// for (let j=0; j<=170; j++) {
//   let testVal = factorial(j);
//   if (Math.abs(testVal - C.FACTORIALS_ARRAY[j])/C.FACTORIALS_ARRAY[j] > 1e-16) {
//     console.log("expected:", C.FACTORIALS_ARRAY[j], ", got:", testVal);
//   }
// }


console.log(Math.sqrt(1+1e-12));
